var E=(T,k,p)=>new Promise((C,_)=>{var s=n=>{try{r(p.next(n))}catch(g){_(g)}},v=n=>{try{r(p.throw(n))}catch(g){_(g)}},r=n=>n.done?C(n.value):Promise.resolve(n.value).then(s,v);r((p=p.apply(T,k)).next())});import{g as J,r as j}from"./index-739OTFba.js";import{r as K}from"./setData-BXCfuNPN.js";import{t as Q}from"./index-DJyng-Qi.js";import{d as W,i,h as N,j as Y,r as u,X as Z,o as y,k as R,b as z,e as a,w as o,H as ee,a as $,f as m,t as x,at as ae,u as te,ao as le,F as oe,au as ne,z as F,_ as se}from"./index-Dxllzmhq.js";const ie={class:"dataReview leftTable"},re={style:{color:"#dd2c2c"}},de={class:"dialog-footer"},ue=W({name:"dataReview",__name:"index",setup(T){const k=i("-1"),p=(l,t)=>{Object.assign(s,{review_state:l.props.name}),n()},C=i(),_=i(0),s=N({page:1,page_size:10,review_state:"-1"}),v=i(!1),r=N([]);function n(){v.value=!0,J(s).then(l=>{r.splice(0,r.length),Object.assign(r,l.data.results),_.value=l.data.count}).finally(()=>{v.value=!1})}const g=l=>{s.page_size=l,n()};function h(l){s.page=l,n()}const D=l=>{var t;return(t=K.find(c=>c.value==l))==null?void 0:t.label};function L(l){ne.confirm("确认模板内容已经无误，是否确认通过？","审核通过",{confirmButtonText:"确认通过",cancelButtonText:"取消",center:!0}).then(()=>E(this,null,function*(){j({tid:l.id,approved:!0}).then(t=>{F.success("审核成功"),h(1)})}))}const f=i(""),b=i(!1),B=i();function M(l){B.value=l,b.value=!0,f.value=""}const I=()=>{j({tid:B.value.id,approved:!1,reason:f.value}).then(l=>{F.success("操作成功"),h(1),b.value=!1})},V=i(!1),S=i();function O(l){V.value=!0,S.value=l.id}return Y(()=>{n()}),(l,t)=>{const c=u("el-tab-pane"),q=u("el-tabs"),d=u("el-table-column"),A=u("el-tooltip"),w=u("el-button"),H=u("el-pagination"),P=u("el-input"),X=u("el-dialog"),G=Z("loading");return y(),R(oe,null,[z("div",ie,[a(q,{modelValue:k.value,"onUpdate:modelValue":t[0]||(t[0]=e=>k.value=e),class:"demo-tabs",onTabClick:p},{default:o(()=>[a(c,{label:"全部",name:"-1"}),a(c,{label:"待审核",name:"0"}),a(c,{label:"已通过",name:"1"}),a(c,{label:"未通过",name:"2"})]),_:1},8,["modelValue"]),ee((y(),$(te(le),{ref_key:"multipleTableRef",ref:C,size:"large",data:r,class:"mb-20",style:{width:"100%"}},{default:o(()=>[a(d,{label:"序号",type:"index",index:1,width:"60",align:"center"}),a(d,{label:"模板名称","show-overflow-tooltip":"",prop:"title",width:"120",align:"center"}),a(d,{label:"摘要","show-overflow-tooltip":"",prop:"abstract","min-width":"300",align:"center"}),a(d,{label:"上传人",prop:"real_name"}),a(d,{label:"审核人",prop:"reviewer_real_name",align:"center"}),a(d,{label:"审核状态",prop:"review_state",width:"100",align:"center"},{default:o(e=>[e.row.review_state==2?(y(),$(A,{key:0,placement:"top"},{content:o(()=>[m(x(e.row.disapprove_reason),1)]),default:o(()=>[z("span",re,x(D(e.row.review_state)),1)]),_:2},1024)):(y(),R("span",{key:1,style:ae({color:e.row.review_state==1?"#888888":"#E5A303"})},x(D(e.row.review_state)),5))]),_:1}),a(d,{label:"上传时间",prop:"pub_date",width:"170"}),a(d,{label:"操作",width:"200",fixed:"right",align:"center"},{default:o(e=>[a(w,{link:"",size:"small",onClick:U=>O(e.row)},{default:o(()=>[m("查看")]),_:2},1032,["onClick"]),a(w,{disabled:e.row.review_state!=0,link:"",type:"primary",size:"small",onClick:U=>L(e.row)},{default:o(()=>[m(" 通过 ")]),_:2},1032,["disabled","onClick"]),a(w,{disabled:e.row.review_state!=0,link:"",type:"danger",size:"small",onClick:U=>M(e.row)},{default:o(()=>[m(" 拒绝 ")]),_:2},1032,["disabled","onClick"])]),_:1})]),_:1},8,["data"])),[[G,v.value]]),a(H,{"current-page":s.page,"onUpdate:currentPage":t[1]||(t[1]=e=>s.page=e),"page-size":s.page_size,"onUpdate:pageSize":t[2]||(t[2]=e=>s.page_size=e),"page-sizes":[5,10,15,20],background:"",layout:"->,prev,pager,next,sizes,jumper,total",total:_.value,onSizeChange:g,onCurrentChange:h},null,8,["current-page","page-size","total"])]),a(X,{modal:"","close-on-click-modal":!1,modelValue:b.value,"onUpdate:modelValue":t[5]||(t[5]=e=>b.value=e),title:"拒绝审核",width:"500"},{footer:o(()=>[z("div",de,[a(w,{size:"large",onClick:t[4]||(t[4]=e=>b.value=!1)},{default:o(()=>[m("取消")]),_:1}),a(w,{size:"large",type:"primary",disabled:f.value=="",onClick:I},{default:o(()=>[m(" 确定 ")]),_:1},8,["disabled"])])]),default:o(()=>[z("div",null,[a(P,{modelValue:f.value,"onUpdate:modelValue":t[3]||(t[3]=e=>f.value=e),type:"textarea",placeholder:"请输入不通过原因"},null,8,["modelValue"])])]),_:1},8,["modelValue"]),a(Q,{modelValue:V.value,"onUpdate:modelValue":t[6]||(t[6]=e=>V.value=e),id:S.value,isDownload:!0},null,8,["modelValue","id"])],64)}}}),ge=se(ue,[["__scopeId","data-v-24b49101"]]);export{ge as default};
